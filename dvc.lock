schema: '2.0'
stages:
  train_autoencoder:
    cmd: python logo_maker/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        AutoEncoderParams:
          ADVERSARIAL_LOSS_WEIGHT: 1
          BATCH_SIZE: 128
          EPOCHS: 50
          KL_LOSS_WEIGHT: 1
          LEARNING_RATE: 0.0004
        DatasetParams:
          CLUSTER:
          N_IMAGES: 37376
          SHUFFLE_DATA: true
          USE_MNIST: true
    outs:
    - path: outs/train_autoencoder/loss.csv
      md5: 8c9796046f1144c2ba476bccde401b72
      size: 1166
    - path: outs/train_autoencoder/model.pt
      md5: b205f79b4d6d26f5730e630af8d80e9e
      size: 3477013
  train_diffusion_model:
    cmd: python logo_maker/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        DatasetParams:
          CLUSTER:
          N_IMAGES: 37376
          SHUFFLE_DATA: true
          USE_MNIST: true
        DiffusionModelParams:
          BATCH_SIZE: 128
          DIFFUSION_STEPS: 1000
          EMBEDDING_DIMENSION: 32
          EPOCHS: 10
          LEARNING_RATE: 0.001
          VAR_SCHEDULE_START: 0.0001
          VAR_SCHEDULE_END: 0.02
    outs:
    - path: outs/train_diffusion_model/loss.csv
      md5: ac93ddd973e524f5e2324a24eac6aece
      size: 245
    - path: outs/train_diffusion_model/model.pt
      md5: f0faa6c6a1d9121cea100b16b5c3bd09
      size: 54153325
  draw_samples:
    cmd: python logo_maker/probe_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/train_autoencoder/model.pt
      md5: b205f79b4d6d26f5730e630af8d80e9e
      size: 3477013
    - path: outs/train_diffusion_model/model.pt
      md5: f0faa6c6a1d9121cea100b16b5c3bd09
      size: 54153325
  train_autoencoder_lld:
    cmd: python favicon_gen/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      favicon_gen/params.py:
        AutoEncoder:
          adversarial_loss_weight: 1
          batch_size: 512
          epochs_mnist: 35
          epochs_lld: 300
          kl_loss_weight: 1
          learning_rate: 0.0004
        DO_NORM: true
        Dataset:
          clusters:
          - 0
          - 1
          - 2
          n_images:
          shuffle: true
        EMBEDDING_DIM: 32
    outs:
    - path: outs/train_autoencoder_lld/loss.csv
      hash: md5
      md5: fd0c0d95b83bd43ddb349fce4b46f9e6
      size: 7068
    - path: outs/train_autoencoder_lld/model.pt
      hash: md5
      md5: 6b55eb6481cad42129e70894f4a93ce4
      size: 18648205
  train_autoencoder_mnist:
    cmd: python favicon_gen/autoencoder.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      favicon_gen/params.py:
        AutoEncoder:
          adversarial_loss_weight: 1
          batch_size: 512
          epochs_mnist: 30
          epochs_lld: 40
          kl_loss_weight: 1
          learning_rate: 0.0004
        DO_NORM: true
        Dataset:
          clusters:
          - 0
          - 1
          - 2
          - 3
          - 4
          - 5
          - 6
          - 7
          - 8
          - 9
          n_images:
          shuffle: true
        EMBEDDING_DIM: 32
    outs:
    - path: outs/train_autoencoder_mnist/loss.csv
      hash: md5
      md5: ec446a45e2234bad7cd4f00904219150
      size: 690
    - path: outs/train_autoencoder_mnist/model.pt
      hash: md5
      md5: 1c30825017b6b039d5c22867c8f54d2a
      size: 21566285
  draw_samples_mnist:
    cmd: python favicon_gen/sample_from_model.py --use_mnist --use_gpu --n_samples
      64
    deps:
    - path: outs/train_autoencoder_mnist/model.pt
      hash: md5
      md5: 1c30825017b6b039d5c22867c8f54d2a
      size: 21566285
    - path: outs/train_diffusion_model_mnist/model.pt
      hash: md5
      md5: 9e0b774da017a4e20c2b3c8d0213ad20
      size: 63514665
  draw_samples_lld:
    cmd: python favicon_gen/sample_from_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/train_autoencoder_lld/model.pt
      hash: md5
      md5: cb729cf9bdcf098bc41c41ecea7819c5
      size: 21597325
    - path: outs/train_diffusion_model_lld/model.pt
      hash: md5
      md5: 6f3b9949cd39fbb8c60c1788f5cdbd06
      size: 63535145
  train_diffusion_model_mnist:
    cmd: python favicon_gen/denoising_diffusion.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      favicon_gen/params.py:
        DO_NORM: true
        Dataset:
          clusters:
          - 0
          - 1
          - 2
          - 3
          - 4
          - 5
          - 6
          - 7
          - 8
          - 9
          n_images:
          shuffle: true
        Diffusion:
          batch_size: 512
          epochs_mnist: 30
          epochs_lld: 40
          guiding_factor: 0.9
          learning_rate: 0.001
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
        EMBEDDING_DIM: 32
    outs:
    - path: outs/train_diffusion_model_mnist/loss.csv
      hash: md5
      md5: 1158b83dc9a0c7f34c26a6c873b6f7c6
      size: 740
    - path: outs/train_diffusion_model_mnist/model.pt
      hash: md5
      md5: 9e0b774da017a4e20c2b3c8d0213ad20
      size: 63514665
  train_diffusion_model_lld:
    cmd: python favicon_gen/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      favicon_gen/params.py:
        DO_NORM: true
        Dataset:
          clusters:
          - 0
          - 1
          - 2
          - 3
          - 4
          - 5
          - 6
          - 7
          - 8
          - 9
          n_images:
          shuffle: true
        Diffusion:
          batch_size: 512
          epochs_mnist: 30
          epochs_lld: 40
          guiding_factor: 0.9
          learning_rate: 0.001
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
        EMBEDDING_DIM: 32
    outs:
    - path: outs/train_diffusion_model_lld/loss.csv
      hash: md5
      md5: 88e2e76c015bb45100abf9809dfc2287
      size: 978
    - path: outs/train_diffusion_model_lld/model.pt
      hash: md5
      md5: 6f3b9949cd39fbb8c60c1788f5cdbd06
      size: 63535145
