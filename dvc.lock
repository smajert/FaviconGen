schema: '2.0'
stages:
  train_autoencoder:
    cmd: python logo_maker/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        AutoEncoderParams:
          ADVERSARIAL_LOSS_WEIGHT: 1
          BATCH_SIZE: 128
          EPOCHS: 50
          KL_LOSS_WEIGHT: 1
          LEARNING_RATE: 0.0004
        DatasetParams:
          CLUSTER:
          N_IMAGES: 37376
          SHUFFLE_DATA: true
          USE_MNIST: true
    outs:
    - path: outs/train_autoencoder/loss.csv
      md5: 8c9796046f1144c2ba476bccde401b72
      size: 1166
    - path: outs/train_autoencoder/model.pt
      md5: b205f79b4d6d26f5730e630af8d80e9e
      size: 3477013
  train_diffusion_model:
    cmd: python logo_maker/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        DatasetParams:
          CLUSTER:
          N_IMAGES: 37376
          SHUFFLE_DATA: true
          USE_MNIST: true
        DiffusionModelParams:
          BATCH_SIZE: 128
          DIFFUSION_STEPS: 1000
          EMBEDDING_DIMENSION: 32
          EPOCHS: 10
          LEARNING_RATE: 0.001
          VAR_SCHEDULE_START: 0.0001
          VAR_SCHEDULE_END: 0.02
    outs:
    - path: outs/train_diffusion_model/loss.csv
      md5: ac93ddd973e524f5e2324a24eac6aece
      size: 245
    - path: outs/train_diffusion_model/model.pt
      md5: f0faa6c6a1d9121cea100b16b5c3bd09
      size: 54153325
  draw_samples:
    cmd: python logo_maker/probe_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/train_autoencoder/model.pt
      md5: b205f79b4d6d26f5730e630af8d80e9e
      size: 3477013
    - path: outs/train_diffusion_model/model.pt
      md5: f0faa6c6a1d9121cea100b16b5c3bd09
      size: 54153325
  train_autoencoder_lld:
    cmd: python logo_maker/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        AutoEncoderParams:
          ADVERSARIAL_LOSS_WEIGHT: 1
          BATCH_SIZE: 128
          EPOCHS_MNIST: 25
          EPOCHS_LLD: 20
          KL_LOSS_WEIGHT: 1
          LEARNING_RATE: 0.0004
        DatasetParams:
          CLUSTER:
          N_IMAGES:
          SHUFFLE_DATA: true
    outs:
    - path: outs/train_autoencoder_lld/loss.csv
      md5: aca00d23fc48834fe39f846c4e9b425e
      size: 461
    - path: outs/train_autoencoder_lld/model.pt
      md5: 1c1ea9e745d5e0efcb4a5c91520539fd
      size: 13817125
  train_autoencoder_mnist:
    cmd: python logo_maker/autoencoder.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        AutoEncoderParams:
          ADVERSARIAL_LOSS_WEIGHT: 1
          BATCH_SIZE: 128
          EPOCHS_MNIST: 25
          EPOCHS_LLD: 20
          KL_LOSS_WEIGHT: 1
          LEARNING_RATE: 0.0004
        DatasetParams:
          CLUSTER:
          N_IMAGES:
          SHUFFLE_DATA: true
    outs:
    - path: outs/train_autoencoder_mnist/loss.csv
      md5: 90f511f22c5f6e103c63a276532406da
      size: 567
    - path: outs/train_autoencoder_mnist/model.pt
      md5: 0e711de573ed3e31cc44478ad556054a
      size: 13807461
  draw_samples_mnist:
    cmd: python logo_maker/sample_from_model.py --use_mnist --use_gpu --n_samples
      64
    deps:
    - path: outs/train_autoencoder_mnist/model.pt
      md5: 0e711de573ed3e31cc44478ad556054a
      size: 13807461
    - path: outs/train_diffusion_model_mnist/model.pt
      md5: 447c4acd08f1f5c46010f91291ff4d84
      size: 13577725
  draw_samples_lld:
    cmd: python logo_maker/sample_from_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/train_autoencoder_lld/model.pt
      md5: 1c1ea9e745d5e0efcb4a5c91520539fd
      size: 13817125
    - path: outs/train_diffusion_model_lld/model.pt
      md5: 376a7caeaf9049df2155e772f5473f12
      size: 13582973
  train_diffusion_model_mnist:
    cmd: python logo_maker/denoising_diffusion.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        DatasetParams:
          CLUSTER:
          N_IMAGES:
          SHUFFLE_DATA: true
        DiffusionModelParams:
          BATCH_SIZE: 128
          DIFFUSION_STEPS: 1000
          EMBEDDING_DIMENSION: 32
          EPOCHS_MNIST: 25
          EPOCHS_LLD: 20
          LEARNING_RATE: 0.001
          VAR_SCHEDULE_START: 0.0001
          VAR_SCHEDULE_END: 0.02
    outs:
    - path: outs/train_diffusion_model_mnist/loss.csv
      md5: 69938947b8fc67d046cf51ae51bfe255
      size: 614
    - path: outs/train_diffusion_model_mnist/model.pt
      md5: 447c4acd08f1f5c46010f91291ff4d84
      size: 13577725
  train_diffusion_model_lld:
    cmd: python logo_maker/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      logo_maker/params.py:
        DatasetParams:
          CLUSTER:
          N_IMAGES:
          SHUFFLE_DATA: true
        DiffusionModelParams:
          BATCH_SIZE: 128
          DIFFUSION_STEPS: 1000
          EMBEDDING_DIMENSION: 32
          EPOCHS_MNIST: 25
          EPOCHS_LLD: 20
          LEARNING_RATE: 0.001
          VAR_SCHEDULE_START: 0.0001
          VAR_SCHEDULE_END: 0.02
    outs:
    - path: outs/train_diffusion_model_lld/loss.csv
      md5: 1c072b5410a0a69bf6ad83eb259e1602
      size: 491
    - path: outs/train_diffusion_model_lld/model.pt
      md5: 376a7caeaf9049df2155e772f5473f12
      size: 13582973
