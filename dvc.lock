schema: '2.0'
stages:
  train_autoencoder:
    cmd: python favicon_gen/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        autoencoder:
          adversarial_loss_weight: 1.0
          batch_size: 512
          epochs_mnist: 20
          epochs_lld: 100
          kl_loss_weight: 1.0
          learning_rate: 0.0004
        dataset:
          name: LLD
          specific_clusters:
          - 0
          - 1
          - 2
          n_images:
          shuffle: true
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_autoencoder/loss.csv
      hash: md5
      md5: 2afcf15ace22f56b30beb565aed3feec
      size: 2293
    - path: outs/train_autoencoder/model.pt
      hash: md5
      md5: 8ecd7ba7a09263204f00470d8ce2fb19
      size: 18708753
  train_diffusion_model:
    cmd: python favicon_gen/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        dataset:
          name: LLD
          specific_clusters:
          - 0
          - 1
          - 2
          n_images:
          shuffle: true
        diffusion:
          batch_size: 32
          epochs_mnist: 20
          epochs_lld: 100
          guiding_factor: 0.9
          learning_rate: 0.01
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_diffusion_model/loss.csv
      hash: md5
      md5: ba04ec94ec32396e558222f2190de612
      size: 2414
    - path: outs/train_diffusion_model/model.pt
      hash: md5
      md5: 956651012fd4d4018424a453a2d34710
      size: 58607529
  draw_samples:
    cmd: python favicon_gen/sample_from_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/model.pt
      hash: md5
      md5: 24e494bcc19f601c45a8fa1d5c85afa3
      size: 64513517
    params:
      params.yaml:
        dataset:
          name: LLD
          specific_clusters:
          - 0
          - 1
          - 2
          - 3
          - 4
          - 5
          n_images: 1
          shuffle: true
  train_autoencoder_lld:
    cmd: python favicon_gen/autoencoder.py
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        autoencoder:
          adversarial_loss_weight: 1.0
          batch_size: 512
          epochs_mnist: 20
          epochs_lld: 200
          kl_loss_weight: 1.0
          learning_rate: 0.0004
        dataset:
          specific_clusters:
          - 0
          n_images: 128
          shuffle: true
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_autoencoder_lld/loss.csv
      hash: md5
      md5: c095212bf46ae8b486f16eb221871951
      size: 4686
    - path: outs/train_autoencoder_lld/model.pt
      hash: md5
      md5: b63e2fcf45016fe2ff5bc1a235cb11f2
      size: 18708497
  train_autoencoder_mnist:
    cmd: python favicon_gen/autoencoder.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        autoencoder:
          adversarial_loss_weight: 1.0
          batch_size: 512
          epochs_mnist: 20
          epochs_lld: 200
          kl_loss_weight: 1.0
          learning_rate: 0.0004
        dataset:
          specific_clusters:
          - 0
          n_images: 128
          shuffle: true
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_autoencoder_mnist/loss.csv
      hash: md5
      md5: 31f2c0f5bad7baa78a03d877baacb29a
      size: 459
    - path: outs/train_autoencoder_mnist/model.pt
      hash: md5
      md5: c2e687fa031dba17ef40254db917a3bb
      size: 18705937
  draw_samples_mnist:
    cmd: python favicon_gen/sample_from_model.py --use_mnist --use_gpu --n_samples
      64
    deps:
    - path: outs/train_autoencoder_mnist/model.pt
      hash: md5
      md5: c2e687fa031dba17ef40254db917a3bb
      size: 18705937
    - path: outs/train_diffusion_model_mnist/model.pt
      hash: md5
      md5: ea1264dfba0645b41a75ec9689de5c6e
      size: 58599465
  draw_samples_lld:
    cmd: python favicon_gen/sample_from_model.py --use_gpu --n_samples 64
    deps:
    - path: outs/train_autoencoder_lld/model.pt
      hash: md5
      md5: b63e2fcf45016fe2ff5bc1a235cb11f2
      size: 18708497
    - path: outs/train_diffusion_model_lld/model.pt
      hash: md5
      md5: 7785b32060090ef63ded457db404bdb3
      size: 58607273
  train_diffusion_model_mnist:
    cmd: python favicon_gen/denoising_diffusion.py --use_mnist
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        dataset:
          specific_clusters:
          - 0
          n_images: 128
          shuffle: true
        diffusion:
          batch_size: 32
          epochs_mnist: 20
          epochs_lld: 201
          guiding_factor: 0.9
          learning_rate: 0.01
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_diffusion_model_mnist/loss.csv
      hash: md5
      md5: c45451d179f1b16a472656dfb4adf6c7
      size: 463
    - path: outs/train_diffusion_model_mnist/model.pt
      hash: md5
      md5: ea1264dfba0645b41a75ec9689de5c6e
      size: 58599465
  train_diffusion_model_lld:
    cmd: python favicon_gen/denoising_diffusion.py
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        dataset:
          specific_clusters:
          - 0
          n_images: 128
          shuffle: true
        diffusion:
          batch_size: 32
          epochs_mnist: 20
          epochs_lld: 201
          guiding_factor: 0.9
          learning_rate: 0.01
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
        general:
          device: cuda
          embedding_dim: 32
          do_norm: true
    outs:
    - path: outs/train_diffusion_model_lld/loss.csv
      hash: md5
      md5: f7c1cc4a9d3cb45c21f60abf19bc33a6
      size: 4877
    - path: outs/train_diffusion_model_lld/model.pt
      hash: md5
      md5: 7785b32060090ef63ded457db404bdb3
      size: 58607273
  train_model:
    cmd: python favicon_gen/call_training.py
    deps:
    - path: data/LLD-icon.hdf5
      hash: md5
      md5: 91f56af2235117e44629fa608fed59ef
      size: 798927457
    params:
      params.yaml:
        dataset:
          name: LLD
          specific_clusters:
          - 0
          - 1
          - 2
          - 3
          - 4
          - 5
          n_images: 1
          shuffle: true
        general:
          device: cuda
          do_norm: true
          embedding_dim: 32
          batch_size: 128
          epochs: 10
          learning_rate: 0.0005
          lr_reduction_patience: 5
        model:
          architecture: UNET2D
          guiding_factor:
          steps: 1000
          var_schedule_start: 0.0001
          var_schedule_end: 0.02
    outs:
    - path: outs/loss.csv
      hash: md5
      md5: 864ea7bf9f91ad27320860fbeebe9bf6
      size: 246
    - path: outs/model.pt
      hash: md5
      md5: 24e494bcc19f601c45a8fa1d5c85afa3
      size: 64513517
